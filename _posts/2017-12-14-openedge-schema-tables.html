---
layout: post
title: Openedge Schema Tables
date: '2017-12-14T03:53:00.000-08:00'
categories: [Databases,Progress]
author: Rajesh Nair
tags:
- VST
- schema tables
- 4GL queries
modified_time: '2019-03-11T05:27:44.391-07:00'
thumbnail: https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiTh6qL2lpD565XDl1axONh9DsvBWDebgyY_-OIOQyLrEfar5hv4q2bfUCuEPXVNEl_fIuhDRKGTFf7oyLq6PiwZOsyjKzez5iedeDx99fMQTf5G80Fh5djdxshUVTK30ilD0DiMVosYMzu/s72-c/Capture.PNG
blogger_id: tag:blogger.com,1999:blog-8827475125741824309.post-8460889734332964652
blogger_orig_url: https://csrepo.blogspot.com/2017/12/openedge-schema-tables.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><br /><h3 style="text-align: left;">What are schema tables?</h3><div><br /></div><div><br /></div> Schema tables are metadata: &nbsp;i.e data about data<br /><br /> These are real tables, stored in the database.<br /><br /> It describe what is stored in the database.It includes tables, indexes, sequences, views, etc.,<br /><br /> Describe database physical storage like Areas, extents, transaction logs etc.<br /><br /> Describe users and access rights<br /><br /> 4GL and SQL share most schema tables<br /><br /> SQL has additional “catalog tables” and views.<br /><br /><br /><h3>What are Virtual System Tables (aka VST’s)?</h3><div><br /></div><div><div> Are NOT schema tables</div><div><br /></div><div> NOT real tables</div><div><br /></div><div> VST data are NOT stored anywhere</div><div><br /></div><div> VST records are created “on the fly” when retrieved</div><div><br /></div><div> VST tables describe database status and activity</div><div><br /></div><div> The schema does contain descriptions of VST’s</div></div><div><br /></div><div><br /></div><div>Following will describe some important schema tables which comes with a OE database</div><div><br /></div><div><b>Physical Storage Schema Tables</b></div><div><b><br /></b></div><div><b><br /></b></div><div><b><br /></b></div><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiTh6qL2lpD565XDl1axONh9DsvBWDebgyY_-OIOQyLrEfar5hv4q2bfUCuEPXVNEl_fIuhDRKGTFf7oyLq6PiwZOsyjKzez5iedeDx99fMQTf5G80Fh5djdxshUVTK30ilD0DiMVosYMzu/s1600/Capture.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="252" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiTh6qL2lpD565XDl1axONh9DsvBWDebgyY_-OIOQyLrEfar5hv4q2bfUCuEPXVNEl_fIuhDRKGTFf7oyLq6PiwZOsyjKzez5iedeDx99fMQTf5G80Fh5djdxshUVTK30ilD0DiMVosYMzu/s640/Capture.PNG" width="640" /></a></div><div><b><br /></b></div><div><b><br /></b></div><div><b>Basic 4GL Schema Tables</b></div><div><b><br /></b></div><div><b><br /></b></div><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhXUs9UJ5wNDaYU-zFyzMr0xnc2mGMO1PCWgkBtX5ChO05eLQO-YRapWel-bykgkm3nc2ecrKxogi8aNSes6AhJFA4pFdd6hUmI5kqY1YIUhsb5hA4SJezZ6iksiOvMln1oUoowbHEtu3xx/s1600/CaptureA.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="374" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhXUs9UJ5wNDaYU-zFyzMr0xnc2mGMO1PCWgkBtX5ChO05eLQO-YRapWel-bykgkm3nc2ecrKxogi8aNSes6AhJFA4pFdd6hUmI5kqY1YIUhsb5hA4SJezZ6iksiOvMln1oUoowbHEtu3xx/s640/CaptureA.PNG" width="640" /></a></div><div><b><br /></b></div><div><br /></div><div><br /></div><div><br /></div><h2 style="text-align: left;">How 4GL finds records</h2><div><br /></div><div>When we write a query to fetch a record , schema tables play in the sequence of operations which takes in background to fetch back the queried record.</div><div><br /></div><div>Following are the sequence of operations which happen when we fetch a record</div><div><br /></div><div><br /></div><div><div> Compiler determines which index (perhaps cust-num)</div><div>• R-code has index information</div><div>• Query used to form equality or range bracket</div><div><br /></div><div> At runtime, load schema cache into memory</div><div><br /></div><div> Look up index number (_index.idx-num, # 113)</div><div><br /></div><div> Find _storage-object record for index 113</div><div><br /></div><div> Load into “om cache” so we can use it again</div><div><br /></div><div> Get location of index root block from _storage-object</div><div><br /></div><div> Traverse index b-tree to leaf, perhaps cust-num = 20</div><div><br /></div><div> Get record’s rowid from index leaf block</div><div><br /></div><div> Read data block containing record</div><div><br /></div><div> Copy record to 4GL buffer or network buffer</div></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div>We can utilize these schema tables to take report on various database components.</div><div><br /></div><div>Below are<b> few helpful 4GL queries </b>using the schema table</div><div><br /></div><div><br /></div><h3 style="text-align: left;"><u>List All Tables</u></h3><div><br /></div><div><div>for each _file</div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>where (0 &lt; _file-num) and</div><div><span class="Apple-tab-span" style="white-space: pre;">  </span>(_file-num &lt; 32000):</div><div><br /></div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>display _file-num _file-name</div><div><span class="Apple-tab-span" style="white-space: pre;">  </span>.</div><div>end.</div></div><div><br /></div><div><br /></div><div><h3><u>List Basic Schema Tables</u></h3></div><div><br /></div><div><div>for each _file</div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>where (_file-num &lt; 0) and</div><div><span class="Apple-tab-span" style="white-space: pre;">  </span>(_file-num &gt; -80)</div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>by _file-num descending:</div><div><br /></div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>display _file-num _file-name</div><div><span class="Apple-tab-span" style="white-space: pre;">  </span>.</div><div>end.</div></div><div><b><br /></b></div><div><b><br /></b></div><div><h3><u>List VST Tables</u></h3></div><div><br /></div><div><div>for each _file</div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>where (_file-num &lt; -16384)</div><div><span class="Apple-tab-span" style="white-space: pre;">  </span>by _file-num descending:</div><div><br /></div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>display _file-num _file-name</div><div><span class="Apple-tab-span" style="white-space: pre;">  </span>.</div><div>end.</div></div><div><br /></div><div><br /></div><div><h3><u>List SQL Catalogue Tables</u></h3></div><div><br /></div><div><div>for each _file</div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>where (_file-name begins “_SYS”):</div><div><span class="Apple-tab-span" style="white-space: pre;">  </span>display _file-num _file-name</div><div><span class="Apple-tab-span" style="white-space: pre;">   </span>.</div><div>end.</div></div><div><br /></div><div><br /></div><div><br /></div><h3 style="text-align: left;"><b><u>List Tables and Thier Fields</u></b></h3><div><br /></div><div><div>output to tables.txt.</div><div>for each _file</div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>where (0 &lt; _file-num):</div><div><br /></div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>put _file-name skip.</div><div><br /></div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>for each _field of _file:</div><div><br /></div><div><span class="Apple-tab-span" style="white-space: pre;">  </span>put “ “ _field-name skip.</div><div><br /></div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>end.</div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>put “” skip.</div><div><br /></div><div>end.</div><div>output close.</div></div><div><br /></div><div><br /></div><div><br /></div><div><h3><b><u>List Indexes by Table</u></b></h3></div><div><b><u><br /></u></b></div><div><div>output to index.txt.</div><div>for each _file where _file-num &gt; 0:</div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>put _file-name skip.</div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>for each _index of _file:</div><div><span class="Apple-tab-span" style="white-space: pre;">  </span>put " " _index-name skip.</div><div><span class="Apple-tab-span" style="white-space: pre;">  </span>for each _index-field of _index:</div><div><span class="Apple-tab-span" style="white-space: pre;">   </span>find _field where recid(_field) = _field-recid.</div><div><span class="Apple-tab-span" style="white-space: pre;">   </span>put " " _field-name skip.</div><div><span class="Apple-tab-span" style="white-space: pre;">  </span>end.</div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>end.</div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>put "" skip.</div><div>end.</div><div>output close.</div></div><div><br /></div><div><br /></div><div><b><u>Space Used by Each Area</u></b></div><div><br /></div><div><br /></div><div><div>for each _AreaStatus where(not _AreaStatus-Areaname matches "*AfterImageArea*") no-lock:</div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>display</div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>_AreaStatus-Areanum format "&gt;&gt;&gt;" column-label "Num"</div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>_AreaStatus-Areaname format "x(20)" column-label "AreaName"</div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>_AreaStatus-Totblocks column-label "Tot Block"</div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>_AreaStatus-Hiwater column-label "High Water"</div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>_AreaStatus-Hiwater / _AreaStatus-Totblocks * 100 column-label "%use"</div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>_AreaStatus-Extents format "&gt;&gt;&gt;" column-label "NumExtents"</div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>_AreaStatus-Freenum column-label "Freenum"</div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>_AreaStatus-Rmnum column-label "RMnum".</div><div>end.</div></div><div><b><u><br /></u></b></div><div><b><u><br /></u></b></div><div><b><u>Find Table Currently in Use</u></b></div><div><b><u><br /></u></b></div><div><br /></div><div><div>find first _MyConnection no-lock.</div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>for each _UserTableStat where _UserTableStat-Conn = _MyConnection._MyConn-UserId no-lock:</div><div><span class="Apple-tab-span" style="white-space: pre;">  </span>find _file where _file-num = _UserTableStat-Num no-lock no-error.</div><div><span class="Apple-tab-span" style="white-space: pre;">   </span>if available _file</div><div><span class="Apple-tab-span" style="white-space: pre;">    </span>then</div><div><span class="Apple-tab-span" style="white-space: pre;">   </span>display</div><div><span class="Apple-tab-span" style="white-space: pre;">   </span>_UserTableStat-Num</div><div><span class="Apple-tab-span" style="white-space: pre;">   </span>_file-name format "x(20)"</div><div><span class="Apple-tab-span" style="white-space: pre;">   </span>_UserTableStat-read</div><div><span class="Apple-tab-span" style="white-space: pre;">   </span>format "&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;"</div><div><span class="Apple-tab-span" style="white-space: pre;">   </span>_UserTableStat-create</div><div><span class="Apple-tab-span" style="white-space: pre;">   </span>format "&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;"</div><div><span class="Apple-tab-span" style="white-space: pre;">   </span>_UserTableStat-update</div><div><span class="Apple-tab-span" style="white-space: pre;">   </span>format "&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;"</div><div><span class="Apple-tab-span" style="white-space: pre;">   </span>_UserTableStat-delete</div><div><span class="Apple-tab-span" style="white-space: pre;">   </span>format "&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;".</div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>end.</div></div><div><br /></div><div><br /></div><div><br /></div><div><b><u>Table - Area List</u></b></div><div><b><u><br /></u></b></div><div><b><u><br /></u></b></div><div><div>for each _Area, each _Storageobject where (_Storageobject._Area-number = _Area._Area-number),each _File where (_File._File-Number = _Storageobject._Object-number) and (_File._File-Number &gt; 0) break</div><div>by _File._File-name:</div><div>display _Area._Area-name _File._File-name.</div><div>end.</div><div style="text-decoration: underline;"><br /></div></div><div style="text-decoration: underline;"><br /></div><div style="text-decoration: underline;"><b><br /></b></div><div style="text-decoration: underline;"><b>No Of BI Clusters</b></div><div style="text-decoration: underline;"><br /></div><div style="text-decoration: underline;"><br /></div><div><div>find _AreaStatus where _AreaStatus-Areanum = 3.</div><div>find _dbStatus.</div><div>display _AreaStatus-Hiwater *</div><div>_dbStatus._DbStatus-BiBlkSize /</div><div>_dbStatus-BiClSize /</div><div>1024.</div></div><div style="text-decoration: underline;"><br /></div><div style="text-decoration: underline;"><br /></div><div style="text-decoration: underline;"><br /></div></div>