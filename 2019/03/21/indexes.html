<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Mongo Indexes | VR Exploring</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Mongo Indexes" />
<meta name="author" content="Rajesh Nair" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Index in a database is what bookmark is to a book, it helps the fast traversal and retrieval of documents through indexing of each document of a collection. Features of a mongo index are: *Keys can be of any type * _id is the default index and is unique * other than _id we can explicitly declare an index *array contents can be indexed *subdocuments and subfields can be indexed * Generally more indexes means faster reads and slower writes *Less indexes means slower read and faster writes*Also it is faster to build an index post import than pre import Finding a document using index will minimize the scanning on the collection as the indexed field would be traversed directly instead of scanning the entire collection. Create Index Indexes can be created in mongo using the createIndex method &gt; db.test1.createIndex({age:1}) { &nbsp; &nbsp; &nbsp; &nbsp; &quot;createdCollectionAutomatically&quot; : false, &nbsp; &nbsp; &nbsp; &nbsp; &quot;numIndexesBefore&quot; : 1, &nbsp; &nbsp; &nbsp; &nbsp; &quot;numIndexesAfter&quot; : 2, &nbsp; &nbsp; &nbsp; &nbsp; &quot;ok&quot; : 1 } We can also create a composite index on two or more fields like: &gt; db.sample.createIndex({a:1,b:1}) List Indexes We can list all the created indexes on a collection by using: &gt; db.test1.getIndexes() [ &nbsp; &nbsp; &nbsp; &nbsp; { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;v&quot; : 2, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;key&quot; : { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;_id&quot; : 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;name&quot; : &quot;_id_&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;ns&quot; : &quot;sample1.test1&quot; &nbsp; &nbsp; &nbsp; &nbsp; }, &nbsp; &nbsp; &nbsp; &nbsp; { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;v&quot; : 2, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;key&quot; : { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;age&quot; : 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;name&quot; : &quot;age_1&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;ns&quot; : &quot;sample1.test1&quot; &nbsp; &nbsp; &nbsp; &nbsp; } ] Here we can see the index _id which is the default index and age_1 index which is the index we created above on the field age. Drop Index To delete an index from a collection , we can use the drop index method by providing the index name, for example: &gt; db.test1.dropIndex(&quot;age_1&quot;); { &quot;nIndexesWas&quot; : 2, &quot;ok&quot; : 1 } We cannot delete the _id default index. Types Of Indexes in Mongo 1. Unique Indexes If we create an index as unique ,we cannot insert duplicate values into the collection index field. &gt; db.test1.ensureIndex({&quot;emp_id&quot;:1},{unique:true}) { &nbsp; &nbsp; &nbsp; &nbsp; &quot;createdCollectionAutomatically&quot; : false, &nbsp; &nbsp; &nbsp; &nbsp; &quot;numIndexesBefore&quot; : 1, &nbsp; &nbsp; &nbsp; &nbsp; &quot;numIndexesAfter&quot; : 2, &nbsp; &nbsp; &nbsp; &nbsp; &quot;ok&quot; : 1 } If we now try to add a duplicate entry for the field added as unique index, it will throw error as below: &gt; db.test1.insert({&quot;emp_id&quot;:1012}) WriteResult({ &nbsp; &nbsp; &nbsp; &nbsp; &quot;nInserted&quot; : 0, &nbsp; &nbsp; &nbsp; &nbsp; &quot;writeError&quot; : { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;code&quot; : 11000, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;errmsg&quot; : &quot;E11000 duplicate key error collection: sample1.test1 index: emp_id_1 dup key: { : 1012.0 }&quot; &nbsp; &nbsp; &nbsp; &nbsp; } }) 2. Sparse Indexes For documents with a field which sparsely ( rarely ) exists in a collections documents. 3. TTL Indexes Time to Live indexes, deleted after a certain number of secs. &gt; db.test1.createIndex({&quot;age&quot;:1},{expireAfterSeconds:3600}) { &nbsp; &nbsp; &nbsp; &nbsp; &quot;createdCollectionAutomatically&quot; : false, &nbsp; &nbsp; &nbsp; &nbsp; &quot;numIndexesBefore&quot; : 2, &nbsp; &nbsp; &nbsp; &nbsp; &quot;numIndexesAfter&quot; : 3, &nbsp; &nbsp; &nbsp; &nbsp; &quot;ok&quot; : 1 } &nbsp; &nbsp; &nbsp;&nbsp; 4. Geospatial Indexes These are the indexes for the fields storing Cartesian co-ordinates [x,y]. For example for a collection with below documents with loc as the location co-ordinate field &gt; db.places.find() { &quot;_id&quot; : ObjectId(&quot;5c94ae27e83be8854bda59a8&quot;), &quot;loc&quot; : [ 2, 2 ] } { &quot;_id&quot; : ObjectId(&quot;5c94ae2ae83be8854bda59a9&quot;), &quot;loc&quot; : [ 2, 4 ] } { &quot;_id&quot; : ObjectId(&quot;5c94ae2fe83be8854bda59aa&quot;), &quot;loc&quot; : [ 4, 4 ] } We can create a geospatial index for the field location as below: &gt; db.places.ensureIndex({loc:&quot;2dsphere&quot;}) When we list the index using getIndex method we can see the loc index as: &nbsp; &nbsp;&quot;v&quot; : 2, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;key&quot; : { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;loc&quot; : &quot;2dsphere&quot; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;name&quot; : &quot;loc_2dsphere&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;ns&quot; : &quot;sample1.places&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;2dsphereIndexVersion&quot; : 3 5. Text Indexes Text index can be used where we want to keep text fields as index,. We can create a text index as: &gt;db.items.ensureIndex({name:&quot;text&quot;},{default_language:&quot;english&quot;}) If we list the index using getIndex we can see it as: &nbsp; &nbsp;&quot;v&quot; : 2, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;key&quot; : { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;_fts&quot; : &quot;text&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;_ftsx&quot; : 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;name&quot; : &quot;name_text&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;ns&quot; : &quot;sample1.items&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;default_language&quot; : &quot;english&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;weights&quot; : { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;name&quot; : 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;language_override&quot; : &quot;language&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;textIndexVersion&quot; : 3 Background Index We can set an index to operate on background.Normally we would keep the primary index in background and rest secondary indexes in foreground.Background indexes would be slower than the foreground .We can set an index as background while creating them as: &gt; db.test1.ensureIndex({&quot;name&quot;:1},{background:true})" />
<meta property="og:description" content="Index in a database is what bookmark is to a book, it helps the fast traversal and retrieval of documents through indexing of each document of a collection. Features of a mongo index are: *Keys can be of any type * _id is the default index and is unique * other than _id we can explicitly declare an index *array contents can be indexed *subdocuments and subfields can be indexed * Generally more indexes means faster reads and slower writes *Less indexes means slower read and faster writes*Also it is faster to build an index post import than pre import Finding a document using index will minimize the scanning on the collection as the indexed field would be traversed directly instead of scanning the entire collection. Create Index Indexes can be created in mongo using the createIndex method &gt; db.test1.createIndex({age:1}) { &nbsp; &nbsp; &nbsp; &nbsp; &quot;createdCollectionAutomatically&quot; : false, &nbsp; &nbsp; &nbsp; &nbsp; &quot;numIndexesBefore&quot; : 1, &nbsp; &nbsp; &nbsp; &nbsp; &quot;numIndexesAfter&quot; : 2, &nbsp; &nbsp; &nbsp; &nbsp; &quot;ok&quot; : 1 } We can also create a composite index on two or more fields like: &gt; db.sample.createIndex({a:1,b:1}) List Indexes We can list all the created indexes on a collection by using: &gt; db.test1.getIndexes() [ &nbsp; &nbsp; &nbsp; &nbsp; { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;v&quot; : 2, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;key&quot; : { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;_id&quot; : 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;name&quot; : &quot;_id_&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;ns&quot; : &quot;sample1.test1&quot; &nbsp; &nbsp; &nbsp; &nbsp; }, &nbsp; &nbsp; &nbsp; &nbsp; { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;v&quot; : 2, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;key&quot; : { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;age&quot; : 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;name&quot; : &quot;age_1&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;ns&quot; : &quot;sample1.test1&quot; &nbsp; &nbsp; &nbsp; &nbsp; } ] Here we can see the index _id which is the default index and age_1 index which is the index we created above on the field age. Drop Index To delete an index from a collection , we can use the drop index method by providing the index name, for example: &gt; db.test1.dropIndex(&quot;age_1&quot;); { &quot;nIndexesWas&quot; : 2, &quot;ok&quot; : 1 } We cannot delete the _id default index. Types Of Indexes in Mongo 1. Unique Indexes If we create an index as unique ,we cannot insert duplicate values into the collection index field. &gt; db.test1.ensureIndex({&quot;emp_id&quot;:1},{unique:true}) { &nbsp; &nbsp; &nbsp; &nbsp; &quot;createdCollectionAutomatically&quot; : false, &nbsp; &nbsp; &nbsp; &nbsp; &quot;numIndexesBefore&quot; : 1, &nbsp; &nbsp; &nbsp; &nbsp; &quot;numIndexesAfter&quot; : 2, &nbsp; &nbsp; &nbsp; &nbsp; &quot;ok&quot; : 1 } If we now try to add a duplicate entry for the field added as unique index, it will throw error as below: &gt; db.test1.insert({&quot;emp_id&quot;:1012}) WriteResult({ &nbsp; &nbsp; &nbsp; &nbsp; &quot;nInserted&quot; : 0, &nbsp; &nbsp; &nbsp; &nbsp; &quot;writeError&quot; : { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;code&quot; : 11000, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;errmsg&quot; : &quot;E11000 duplicate key error collection: sample1.test1 index: emp_id_1 dup key: { : 1012.0 }&quot; &nbsp; &nbsp; &nbsp; &nbsp; } }) 2. Sparse Indexes For documents with a field which sparsely ( rarely ) exists in a collections documents. 3. TTL Indexes Time to Live indexes, deleted after a certain number of secs. &gt; db.test1.createIndex({&quot;age&quot;:1},{expireAfterSeconds:3600}) { &nbsp; &nbsp; &nbsp; &nbsp; &quot;createdCollectionAutomatically&quot; : false, &nbsp; &nbsp; &nbsp; &nbsp; &quot;numIndexesBefore&quot; : 2, &nbsp; &nbsp; &nbsp; &nbsp; &quot;numIndexesAfter&quot; : 3, &nbsp; &nbsp; &nbsp; &nbsp; &quot;ok&quot; : 1 } &nbsp; &nbsp; &nbsp;&nbsp; 4. Geospatial Indexes These are the indexes for the fields storing Cartesian co-ordinates [x,y]. For example for a collection with below documents with loc as the location co-ordinate field &gt; db.places.find() { &quot;_id&quot; : ObjectId(&quot;5c94ae27e83be8854bda59a8&quot;), &quot;loc&quot; : [ 2, 2 ] } { &quot;_id&quot; : ObjectId(&quot;5c94ae2ae83be8854bda59a9&quot;), &quot;loc&quot; : [ 2, 4 ] } { &quot;_id&quot; : ObjectId(&quot;5c94ae2fe83be8854bda59aa&quot;), &quot;loc&quot; : [ 4, 4 ] } We can create a geospatial index for the field location as below: &gt; db.places.ensureIndex({loc:&quot;2dsphere&quot;}) When we list the index using getIndex method we can see the loc index as: &nbsp; &nbsp;&quot;v&quot; : 2, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;key&quot; : { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;loc&quot; : &quot;2dsphere&quot; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;name&quot; : &quot;loc_2dsphere&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;ns&quot; : &quot;sample1.places&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;2dsphereIndexVersion&quot; : 3 5. Text Indexes Text index can be used where we want to keep text fields as index,. We can create a text index as: &gt;db.items.ensureIndex({name:&quot;text&quot;},{default_language:&quot;english&quot;}) If we list the index using getIndex we can see it as: &nbsp; &nbsp;&quot;v&quot; : 2, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;key&quot; : { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;_fts&quot; : &quot;text&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;_ftsx&quot; : 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;name&quot; : &quot;name_text&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;ns&quot; : &quot;sample1.items&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;default_language&quot; : &quot;english&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;weights&quot; : { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;name&quot; : 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;language_override&quot; : &quot;language&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;textIndexVersion&quot; : 3 Background Index We can set an index to operate on background.Normally we would keep the primary index in background and rest secondary indexes in foreground.Background indexes would be slower than the foreground .We can set an index as background while creating them as: &gt; db.test1.ensureIndex({&quot;name&quot;:1},{background:true})" />
<link rel="canonical" href="https://vemarahub.github.io/vrexploring/2019/03/21/indexes.html" />
<meta property="og:url" content="https://vemarahub.github.io/vrexploring/2019/03/21/indexes.html" />
<meta property="og:site_name" content="VR Exploring" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-03-21T12:09:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Mongo Indexes" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Rajesh Nair"},"dateModified":"2019-03-21T12:09:00+00:00","datePublished":"2019-03-21T12:09:00+00:00","description":"Index in a database is what bookmark is to a book, it helps the fast traversal and retrieval of documents through indexing of each document of a collection. Features of a mongo index are: *Keys can be of any type * _id is the default index and is unique * other than _id we can explicitly declare an index *array contents can be indexed *subdocuments and subfields can be indexed * Generally more indexes means faster reads and slower writes *Less indexes means slower read and faster writes*Also it is faster to build an index post import than pre import Finding a document using index will minimize the scanning on the collection as the indexed field would be traversed directly instead of scanning the entire collection. Create Index Indexes can be created in mongo using the createIndex method &gt; db.test1.createIndex({age:1}) { &nbsp; &nbsp; &nbsp; &nbsp; &quot;createdCollectionAutomatically&quot; : false, &nbsp; &nbsp; &nbsp; &nbsp; &quot;numIndexesBefore&quot; : 1, &nbsp; &nbsp; &nbsp; &nbsp; &quot;numIndexesAfter&quot; : 2, &nbsp; &nbsp; &nbsp; &nbsp; &quot;ok&quot; : 1 } We can also create a composite index on two or more fields like: &gt; db.sample.createIndex({a:1,b:1}) List Indexes We can list all the created indexes on a collection by using: &gt; db.test1.getIndexes() [ &nbsp; &nbsp; &nbsp; &nbsp; { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;v&quot; : 2, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;key&quot; : { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;_id&quot; : 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;name&quot; : &quot;_id_&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;ns&quot; : &quot;sample1.test1&quot; &nbsp; &nbsp; &nbsp; &nbsp; }, &nbsp; &nbsp; &nbsp; &nbsp; { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;v&quot; : 2, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;key&quot; : { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;age&quot; : 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;name&quot; : &quot;age_1&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;ns&quot; : &quot;sample1.test1&quot; &nbsp; &nbsp; &nbsp; &nbsp; } ] Here we can see the index _id which is the default index and age_1 index which is the index we created above on the field age. Drop Index To delete an index from a collection , we can use the drop index method by providing the index name, for example: &gt; db.test1.dropIndex(&quot;age_1&quot;); { &quot;nIndexesWas&quot; : 2, &quot;ok&quot; : 1 } We cannot delete the _id default index. Types Of Indexes in Mongo 1. Unique Indexes If we create an index as unique ,we cannot insert duplicate values into the collection index field. &gt; db.test1.ensureIndex({&quot;emp_id&quot;:1},{unique:true}) { &nbsp; &nbsp; &nbsp; &nbsp; &quot;createdCollectionAutomatically&quot; : false, &nbsp; &nbsp; &nbsp; &nbsp; &quot;numIndexesBefore&quot; : 1, &nbsp; &nbsp; &nbsp; &nbsp; &quot;numIndexesAfter&quot; : 2, &nbsp; &nbsp; &nbsp; &nbsp; &quot;ok&quot; : 1 } If we now try to add a duplicate entry for the field added as unique index, it will throw error as below: &gt; db.test1.insert({&quot;emp_id&quot;:1012}) WriteResult({ &nbsp; &nbsp; &nbsp; &nbsp; &quot;nInserted&quot; : 0, &nbsp; &nbsp; &nbsp; &nbsp; &quot;writeError&quot; : { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;code&quot; : 11000, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;errmsg&quot; : &quot;E11000 duplicate key error collection: sample1.test1 index: emp_id_1 dup key: { : 1012.0 }&quot; &nbsp; &nbsp; &nbsp; &nbsp; } }) 2. Sparse Indexes For documents with a field which sparsely ( rarely ) exists in a collections documents. 3. TTL Indexes Time to Live indexes, deleted after a certain number of secs. &gt; db.test1.createIndex({&quot;age&quot;:1},{expireAfterSeconds:3600}) { &nbsp; &nbsp; &nbsp; &nbsp; &quot;createdCollectionAutomatically&quot; : false, &nbsp; &nbsp; &nbsp; &nbsp; &quot;numIndexesBefore&quot; : 2, &nbsp; &nbsp; &nbsp; &nbsp; &quot;numIndexesAfter&quot; : 3, &nbsp; &nbsp; &nbsp; &nbsp; &quot;ok&quot; : 1 } &nbsp; &nbsp; &nbsp;&nbsp; 4. Geospatial Indexes These are the indexes for the fields storing Cartesian co-ordinates [x,y]. For example for a collection with below documents with loc as the location co-ordinate field &gt; db.places.find() { &quot;_id&quot; : ObjectId(&quot;5c94ae27e83be8854bda59a8&quot;), &quot;loc&quot; : [ 2, 2 ] } { &quot;_id&quot; : ObjectId(&quot;5c94ae2ae83be8854bda59a9&quot;), &quot;loc&quot; : [ 2, 4 ] } { &quot;_id&quot; : ObjectId(&quot;5c94ae2fe83be8854bda59aa&quot;), &quot;loc&quot; : [ 4, 4 ] } We can create a geospatial index for the field location as below: &gt; db.places.ensureIndex({loc:&quot;2dsphere&quot;}) When we list the index using getIndex method we can see the loc index as: &nbsp; &nbsp;&quot;v&quot; : 2, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;key&quot; : { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;loc&quot; : &quot;2dsphere&quot; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;name&quot; : &quot;loc_2dsphere&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;ns&quot; : &quot;sample1.places&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;2dsphereIndexVersion&quot; : 3 5. Text Indexes Text index can be used where we want to keep text fields as index,. We can create a text index as: &gt;db.items.ensureIndex({name:&quot;text&quot;},{default_language:&quot;english&quot;}) If we list the index using getIndex we can see it as: &nbsp; &nbsp;&quot;v&quot; : 2, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;key&quot; : { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;_fts&quot; : &quot;text&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;_ftsx&quot; : 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;name&quot; : &quot;name_text&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;ns&quot; : &quot;sample1.items&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;default_language&quot; : &quot;english&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;weights&quot; : { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;name&quot; : 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;language_override&quot; : &quot;language&quot;, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;textIndexVersion&quot; : 3 Background Index We can set an index to operate on background.Normally we would keep the primary index in background and rest secondary indexes in foreground.Background indexes would be slower than the foreground .We can set an index as background while creating them as: &gt; db.test1.ensureIndex({&quot;name&quot;:1},{background:true})","headline":"Mongo Indexes","mainEntityOfPage":{"@type":"WebPage","@id":"https://vemarahub.github.io/vrexploring/2019/03/21/indexes.html"},"url":"https://vemarahub.github.io/vrexploring/2019/03/21/indexes.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/vrexploring/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://vemarahub.github.io/vrexploring/feed.xml" title="VR Exploring" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/vrexploring/">VR Exploring</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/vrexploring/about/">About</a><a class="page-link" href="/vrexploring/">Home</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Mongo Indexes</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2019-03-21T12:09:00+00:00" itemprop="datePublished">Mar 21, 2019
      </time>â€¢ <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Rajesh Nair</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <div dir="ltr" style="text-align: left;" trbidi="on">
Index in a database is what bookmark is to a book, it helps the fast traversal and retrieval of documents through indexing of each document of a collection.<br />
Features of a mongo index are:<br />
*Keys can be of any type<br />
* _id is the default index and is unique<br />
* other than _id we can explicitly declare an index<br />
*array contents can be indexed<br />
*subdocuments and subfields can be indexed<br />
<div>
* Generally more indexes means faster reads and slower writes</div>
<div>
*Less indexes means slower read and faster writes<br />*Also it is faster to build an index post import than pre import</div>
<br />
Finding a document using index will minimize the scanning on the collection as the indexed field would be traversed directly instead of scanning the entire collection.<br />
<br />
<b>Create Index</b><br />
Indexes can be created in mongo using the createIndex method<br />
<b>&gt; db.test1.createIndex({age:1})</b><br />
<i>{</i><br />
<i>&nbsp; &nbsp; &nbsp; &nbsp; "createdCollectionAutomatically" : false,</i><br />
<i>&nbsp; &nbsp; &nbsp; &nbsp; "numIndexesBefore" : 1,</i><br />
<i>&nbsp; &nbsp; &nbsp; &nbsp; "numIndexesAfter" : 2,</i><br />
<i>&nbsp; &nbsp; &nbsp; &nbsp; "ok" : 1</i><br />
<i>}</i><br />
<div>
<br /></div>
<div>
We can also create a composite index on two or more fields like:</div>
<div>
<b>&gt; db.sample.createIndex({a:1,b:1})</b></div>
<div>
<br /></div>
<div>
<b>List Indexes</b></div>
<div>
We can list all the created indexes on a collection by using:</div>
<div>
<div>
<b>&gt; db.test1.getIndexes()</b></div>
<div>
<i>[</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; {</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "v" : 2,</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "key" : {</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "_id" : 1</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "name" : "_id_",</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "ns" : "sample1.test1"</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; },</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; {</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "v" : 2,</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "key" : {</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "age" : 1</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "name" : "age_1",</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "ns" : "sample1.test1"</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; }</i></div>
<div>
<i>]</i></div>
</div>
<div>
<br /></div>
<div>
Here we can see the index _id which is the default index and age_1 index which is the index we created above on the field age.</div>
<div>
<br /></div>
<div>
<b>Drop Index</b></div>
<div>
To delete an index from a collection , we can use the drop index method by providing the index name, for example:</div>
<div>
<div>
<b>&gt; db.test1.dropIndex("age_1");</b></div>
<div>
<i>{ "nIndexesWas" : 2, "ok" : 1 }</i></div>
</div>
<div>
<br /></div>
<div>
We cannot delete the _id default index.</div>
<div>
<br /></div>
<h3 style="text-align: left;">
<b>Types Of Indexes in Mongo</b></h3>
<div>
<b>1. Unique Indexes</b></div>
<div>
If we create an index as unique ,we cannot insert duplicate values into the collection index field.</div>
<div>
<b>&gt; db.test1.ensureIndex({"emp_id":1},{unique:true})</b><br />
<i>{</i><br />
<i>&nbsp; &nbsp; &nbsp; &nbsp; "createdCollectionAutomatically" : false,</i><br />
<i>&nbsp; &nbsp; &nbsp; &nbsp; "numIndexesBefore" : 1,</i><br />
<i>&nbsp; &nbsp; &nbsp; &nbsp; "numIndexesAfter" : 2,</i><br />
<i>&nbsp; &nbsp; &nbsp; &nbsp; "ok" : 1</i><br />
<i>}</i><br />
<br />
If we now try to add a duplicate entry for the field added as unique index, it will throw error as below:<br />
<b>&gt; db.test1.insert({"emp_id":1012})</b><br />
<i>WriteResult({</i><br />
<i>&nbsp; &nbsp; &nbsp; &nbsp; "nInserted" : 0,</i><br />
<i>&nbsp; &nbsp; &nbsp; &nbsp; "writeError" : {</i><br />
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "code" : 11000,</i><br />
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "errmsg" : "E11000 duplicate key error collection: sample1.test1 index: emp_id_1 dup key: { : 1012.0 }"</i><br />
<i>&nbsp; &nbsp; &nbsp; &nbsp; }</i><br />
<i>})</i><br />
<i><br /></i>
<b>2. Sparse Indexes</b></div>
<div>
<div class="MsoNormal">
For documents with a field which sparsely ( rarely ) exists
in a collections documents.<o:p></o:p><br />
<br /></div>
</div>
<div>
<b>3. TTL Indexes</b></div>
<div>
<div class="MsoNormal">
Time to Live indexes, deleted after a certain number of
secs.<o:p></o:p></div>
<div class="MsoNormal">
<b>&gt; db.test1.createIndex({"age":1},{expireAfterSeconds:3600})</b></div>
<div class="MsoNormal">
<i>{</i></div>
<div class="MsoNormal">
<i>&nbsp; &nbsp; &nbsp; &nbsp; "createdCollectionAutomatically" : false,</i></div>
<div class="MsoNormal">
<i>&nbsp; &nbsp; &nbsp; &nbsp; "numIndexesBefore" : 2,</i></div>
<div class="MsoNormal">
<i>&nbsp; &nbsp; &nbsp; &nbsp; "numIndexesAfter" : 3,</i></div>
<div class="MsoNormal">
<i>&nbsp; &nbsp; &nbsp; &nbsp; "ok" : 1</i></div>
<div class="MsoNormal">
<i>}</i></div>
<div>
&nbsp; &nbsp; &nbsp;&nbsp;</div>
<div>
<b>4. Geospatial Indexes</b></div>
<div>
These are the indexes for the fields storing Cartesian co-ordinates [x,y].<br />
For example for a collection with below documents with loc as the location co-ordinate field<br />
&gt; db.places.find()<br />
<i>{ "_id" : ObjectId("5c94ae27e83be8854bda59a8"), "loc" : [ 2, 2 ] }</i><br />
<i>{ "_id" : ObjectId("5c94ae2ae83be8854bda59a9"), "loc" : [ 2, 4 ] }</i><br />
<i>{ "_id" : ObjectId("5c94ae2fe83be8854bda59aa"), "loc" : [ 4, 4 ] }</i><br />
<i><br /></i>
We can create a geospatial index for the field location as below:<br />
<b>&gt; db.places.ensureIndex({loc:"2dsphere"})</b></div>
<div>
<br /></div>
<div>
When we list the index using getIndex method we can see the loc index as:</div>
<div>
<div>
<i>&nbsp; &nbsp;"v" : 2,</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "key" : {</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "loc" : "2dsphere"</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "name" : "loc_2dsphere",</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "ns" : "sample1.places",</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "2dsphereIndexVersion" : 3</i></div>
</div>
<div>
<br /></div>
<div>
<br /></div>
<div>
<b>5. Text Indexes</b></div>
<div>
Text index can be used where we want to keep text fields as index,.</div>
<div>
We can create a text index as:</div>
<div>
<div>
<b>&gt;db.items.ensureIndex({name:"text"},{default_language:"english"})</b></div>
</div>
<div>
<br /></div>
<div>
If we list the index using getIndex we can see it as:</div>
<div>
<div>
<i>&nbsp; &nbsp;"v" : 2,</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "key" : {</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "_fts" : "text",</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "_ftsx" : 1</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "name" : "name_text",</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "ns" : "sample1.items",</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "default_language" : "english",</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "weights" : {</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "name" : 1</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "language_override" : "language",</i></div>
<div>
<i>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "textIndexVersion" : 3</i></div>
</div>
<div>
<br /></div>
<div>
<br /></div>
<div>
<b>Background Index</b></div>
<div>
We can set an index to operate on background.Normally we would keep the primary index in background and rest secondary indexes in foreground.Background indexes would be slower than the foreground .We can set an index as background while creating them as:</div>
<div>
<div>
<b>&gt; db.test1.ensureIndex({"name":1},{background:true})</b></div>
</div>
<div>
<br /></div>
<div>
<br /></div>
<b></b></div>
</div>

  </div><a class="u-url" href="/vrexploring/2019/03/21/indexes.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/vrexploring/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">VR Exploring</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">VR Exploring</li><li><a class="u-email" href="mailto:vrexploring@gmail.com">vrexploring@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/vemarahub"><svg class="svg-icon"><use xlink:href="/vrexploring/assets/minima-social-icons.svg#github"></use></svg> <span class="username">vemarahub</span></a></li><li><a href="https://www.twitter.com/vrexploring"><svg class="svg-icon"><use xlink:href="/vrexploring/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">vrexploring</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>A space where i share my thoughts and experiences about technology , science, life, family and everything in between.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
